<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rifa Seu Miguel</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.6/jquery.inputmask.min.js"></script>
    <style>
        :root {
            --espac: 3px;
        }
        body {
            font-family: Arial;
            background-color: #F6F8F7;
            align-items: center;
            text-align: center;
        }
        label {
            margin: var(--espac);
        }
        input {
            border: 1px solid black;
            outline: none;
            padding: calc(2 * var(--espac));
            margin: var(--espac);
        }
        #titulo {
            text-align: center;
            padding: 10px;
        }
        #tabela {
            text-align: center;
            display: grid;
            grid-template-columns: repeat(10, minmax(70px, 1fr));
            gap: var(--espac);
            width: 100%;
        }
        .loader {
            margin: 15px;
            padding: 7px;
            display: inline-block;
            border: 7px solid #EAF0F6;
            border-radius: 50%;
            border-top: 7px solid #FF7A59;
            width: 70px;
            height: 70px;
            animation: spinner 4s linear infinite;
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #base {
            align-items: center;
            text-align: center;
            width: 95%;
            max-width: 500px;
            margin: 0 auto;
        }
        #info {
            align-items: center;
            text-align: center;
            display: flex;
            flex-direction: column;
        }
        #rifa {
            background-color: white;
            align-items: center;
            text-align: center;
            border-style: solid;
            border-width: thin;
            width: fit-content;
            display: inline-block;
            margin: 10px;
            padding: 10px;
        }
        #btSend {
            width: 150px;
            font-size: 1rem;
            background-color: #779afa;
            padding: calc(2 * var(--espac));
            margin: calc(2 * var(--espac));
            border: 1px solid black;
            border-radius: 6px;
            cursor: pointer;
        }
        #btSend:hover {
            background-color: #648cfa;
        }
        #qtdrifas {
            padding: 4px 20px;
        }
        #premios {
            text-align: justify;
            margin: 3px auto;
        }
    </style>
</head>
    <body>
        <div id="titulo">
            <span>Rifa para ajudar Miguel Rogério em um tratamento de saúde de alto custo.</span>
        </div>
        <div class="loader" id="loader"></div>
        <div id="info">
            <label for="nome">Nome do comprador:</label>
            <input type="text" id="nome" placeholder="Digite Seu Nome"/>
            <label for="telefone">Telefone:</label>
            <input type="tel" id="telefone" placeholder="(00) 00000-0000" title="Digite um número de telefone válido: (00) 00000-0000"/>
            <label for="qtdrifas">Quantidade de rifas:</label>
            <select id="qtdrifas" name="qtdrifas">
                <option value=1>1</option>
                <option value=2>2</option>
                <option value=3>3</option>
                <option value=4>4</option>
                <option value=5>5</option>
                <option value=6>6</option>
                <option value=7>7</option>
                <option value=8>8</option>
                <option value=9>9</option>
                <option value=10>10</option>
            </select>
            <button id="btSend" class="btZap" onclick="enviarFormulario()">Gerar Rifa</button>
        </div>
        <div id="rifa">
            <span>Comprovante de Rifa</span><br><br>
            <span>Ação entre amigos para ajudar seu Miguel Rogério.</span><br>
            <span>[MMMMM], telefone: [TTTTT],</span><br>
            <span>comprou [CCCCC] rifas, no valor de R$ 10,00 cada.</span><br>
            <span>Nós envie esse comprovate para dar baixa do seu pagamento.</span><br>
            <span>Comprovante: [XXXXX]</span>
        </div>
        <div id="base">
            <span>Estamos dando continuidade a companha em forma de rifa, pois o valor do tratamento é de R$ 130.000,00 e ainda falta muito para a gente conseguir. Seguimos na luta!</span><br>
            <span>Data do sorteio: 29/09/2023 sábado.</span><br>
            <span>Serão feitos vários sorteios com os seguintes prêmios:</span>
            <ol id="premios">
                <li>Argola de ouro 24k</li>
                <li>Colcha Queen (3 peças)</li>
                <li>Perfume Lune (Natura)</li>
                <li>Perfume Kaiak (Natura)</li>
                <li>Kit Tododia (Natura)</li>
                <li>Kit masculino (Natura)</li>
                <li>2 Caixas de Sabonete (Natura)</li>
                <li>Panela de Pressão</li>
                <li>Conjunto de Talheres</li>
                <li>Garrafa de Café</li>
                <li>Marinex</li>
                <li>Poncheira Térmica</li>
                <li>Kit de Cordéis (Autores da Terra)</li>
                <li>Livro de Crônicas de Nailson</li>
            </ol>
            <span>Agradecemos muito por sua contribuição!</span>
        </div>
    </body>
    <script>

        $(document).ready(function() {
            $("#telefone").inputmask("(99) 99999-9999");
            $('#loader').hide();
            $('#rifa').hide();
        });

        function stopLoad() {
            $('#rifa').show();
            $('#loader').hide();
        }

        function startLoad() {
            $('#info').hide();
            $('#loader').show();
        }

        function btZapClick() {
            var numeroTelefone = "5584988054083";
            var mensagem = "Quero comprar uma rifa para ajudar Seu Miguel Rogério."; 
            var mensagemCodificada = encodeURIComponent(mensagem);

            var linkWhatsApp = "https://api.whatsapp.com/send?phone=" + numeroTelefone + "&text=" + mensagemCodificada;

            window
            .location.href = linkWhatsApp;
        }

        function enviarFormulario() {
            var nome = document.getElementById("nome").value;
            var telefone = document.getElementById("telefone").value;
            var qtdrifas = document.getElementById("qtdrifas").value;

            var dados = [];

            for(var i = 0; i < qtdrifas; i++) {
                dados.push({
                    nome: nome,
                    telefone: telefone,
                });
            }

            url = 'https://script.google.com/macros/s/AKfycbwgmI-90Jgr55WuWIPX1GxZaPSV52AqOIAFodB6hNQyUzyH6xuBRwT8ixnDLD7F0XfY/exec'

            startLoad();

            fetch(url, {
                method: "POST",
                redirect: "follow",
                headers: {
                    "Content-Type": "text/plain;charset=utf-8"
                },
                body: JSON.stringify(dados)
            })
            .then(response => response.json())
            .then(data => {
                var divResposta = document.getElementById("rifa");
                var text = divResposta.innerHTML
                text = text.replace("[MMMMM]", nome);
                text = text.replace("[TTTTT]", telefone);
                text = text.replace("[CCCCC]", qtdrifas);
                divResposta.innerHTML = text.replace("[XXXXX]", data.codes.join(", "));
                stopLoad();
            })
            .catch(error => {
                console.error("Erro na solicitação:", error);
                stopLoad();
            });
        }
    </script>
</html>